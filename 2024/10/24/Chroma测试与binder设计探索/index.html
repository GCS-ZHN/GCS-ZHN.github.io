<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="Chroma测试与binder设计探索"><meta name="keywords" content="ai,protein design,diffusion"><meta name="author" content="GCS-ZHN,undefined"><meta name="copyright" content="GCS-ZHN"><title>Chroma测试与binder设计探索【潇洒记忆】</title><link rel="stylesheet" href="/css/fan.css"><link rel="stylesheet" href="/css/thirdparty/jquery.mCustomScrollbar.min.css"><link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css"><link rel="icon" href="/favicon.ico"><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!-- script(src=url_for("/js/mathjax/mathjax.js"))--><script type="text/x-mathjax-config">MathJax.Hub.Config({
    tex2jax: {inlineMath: [['$', '$'], ['\\(', '\\)']]}
});
</script><script>var isPassword = '' || false;
if (isPassword) {
    if (prompt('请输入文章密码') !== '') {
        alert('密码错误！');
        history.back();
    }
}</script><script>window.GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  gitment: {},
  valine: {},
}</script><meta name="generator" content="Hexo 6.0.0"></head><body><canvas id="universe"></canvas><!--#body--><div id="sidebar"><div class="toggle-sidebar-info button-hover"><span data-toggle="文章目录">站点概览</span></div><div class="sidebar-toc"><div class="sidebar-toc-title">目录</div><div class="sidebar-toc-progress"><span class="progress-notice">您已阅读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc-progress-bar"></div></div><div class="sidebar-toc-content" id="sidebar-toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E5%8A%9F%E8%83%BD%E6%B5%8B%E8%AF%95"><span class="toc-number">1.</span> <span class="toc-text">基本功能测试</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%A0%E6%9D%A1%E4%BB%B6%E9%87%87%E6%A0%B7%EF%BC%88Unconditonal-Sampling%EF%BC%89"><span class="toc-number">1.1.</span> <span class="toc-text">无条件采样（Unconditonal Sampling）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8C%87%E5%AE%9A%E4%BA%8C%E7%BA%A7%E7%BB%93%E6%9E%84%E9%87%87%E6%A0%B7%EF%BC%88Secondary-Structure-Sampling%EF%BC%89"><span class="toc-number">1.2.</span> <span class="toc-text">指定二级结构采样（Secondary Structure Sampling）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%A6%E5%8F%B7%E5%BD%A2%E7%8A%B6%E9%87%87%E6%A0%B7%EF%BC%88Symbol-like-Structure-Sampling%EF%BC%89"><span class="toc-number">1.3.</span> <span class="toc-text">符号形状采样（Symbol-like Structure Sampling）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CATH%E9%87%87%E6%A0%B7%EF%BC%88CATH-based-Structure-Sampling%EF%BC%89"><span class="toc-number">1.4.</span> <span class="toc-text">CATH采样（CATH-based Structure Sampling）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8F%90%E7%A4%BA%E8%AF%8D%E9%87%87%E6%A0%B7%EF%BC%88Prompt-based-Structure-Sampling%EF%BC%89"><span class="toc-number">1.5.</span> <span class="toc-text">提示词采样（Prompt-based Structure Sampling）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%A8%E7%BB%93%E6%9E%84%E9%87%8D%E9%87%87%E6%A0%B7%EF%BC%88Full-structure-resampling%EF%BC%89"><span class="toc-number">1.6.</span> <span class="toc-text">全结构重采样（Full structure resampling）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B1%80%E9%83%A8%E9%87%8D%E9%87%87%E6%A0%B7%EF%BC%88Partial-structure-resampling%EF%BC%89"><span class="toc-number">1.7.</span> <span class="toc-text">局部重采样（Partial structure resampling）</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Denovo-Binder-Design"><span class="toc-number">2.</span> <span class="toc-text">Denovo Binder Design</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Fc-Fragment-Binder-design"><span class="toc-number">2.1.</span> <span class="toc-text">Fc Fragment Binder design</span></a></li></ol></li></ol></div></div><div class="author-info hide"><div class="author-info-avatar"><img class="author-info-avatar-img" src="/avatar.png"></div><div class="author-info-name">GCS-ZHN</div><div class="author-info-description"></div><div class="links-buttons"><a class="links-button button-hover" href="https://github.com/GCS-ZHN" target="_blank">GitHub<i class="icon-dot bg-color7"></i></a><a class="links-button button-hover" href="mailto:zhang.h.n@foxmail.com" target="_blank">E-Mail<i class="icon-dot bg-color4"></i></a></div><div class="author-info-articles"><a class="author-info-articles-archives article-meta" href="/archives"><span class="pull-top">日志</span><span class="pull-bottom">26</span></a><a class="author-info-articles-tags article-meta" href="/tags"><span class="pull-top">标签</span><span class="pull-bottom">55</span></a><a class="author-info-articles-categories article-meta" href="/categories"><span class="pull-top">分类</span><span class="pull-bottom">19</span></a></div></div></div><div id="main-container"><header><div id="menu-outer"><i class="menu-list-icon fas fa-bars"></i><nav id="menu-inner"><a class="menu-item" href="/">首页</a><a class="menu-item" href="/archives">归档</a></nav><div class="right-info"><a class="title-name" href="/">潇洒记忆</a><span id="now-time"></span></div></div></header><div id="content-outer"><div id="content-inner"><article id="post"><div class="post-header"><div class="title">Chroma测试与binder设计探索</div><div class="container"><time class="button-hover post-date"><i class="fas fa-calendar-alt article-icon" aria-hidden="true"></i> 发表于 2024-10-24 | 更新于 2024-10-24</time><!--time.button-hover.post-date #[i.fas.fa-calendar-alt.article-icon(aria-hidden="true")] #[=__('post.modified')] #[=date(page['updated'], config.date_format)]--><div class="button-hover categories"><i class="fa fa-inbox article-icon" aria-hidden="true"></i><a class="link-a" href="/categories/%E8%9B%8B%E7%99%BD%E8%AE%BE%E8%AE%A1/">蛋白设计</a><i class="fa fa-angle-right" style="margin: 0 8px;"></i><i class="fa fa-inbox article-icon" aria-hidden="true"></i><a class="link-a" href="/categories/%E8%9B%8B%E7%99%BD%E8%AE%BE%E8%AE%A1/AI4S/">AI4S</a></div><div class="button-hover tags"><i class="fa fa-tag article-icon" aria-hidden="true"></i><a class="link-a" href="/tags/ai/">ai</a><span>&nbsp;|&nbsp;</span><i class="fa fa-tag article-icon" aria-hidden="true"></i><a class="link-a" href="/tags/protein-design/">protein design</a><span>&nbsp;|&nbsp;</span><i class="fa fa-tag article-icon" aria-hidden="true"></i><a class="link-a" href="/tags/diffusion/">diffusion</a></div></div></div><div class="main-content"><p>Chroma是Generate Bio开发一款蛋白设计算法，可以支持做骨架设计和序列设计。与Baker团队开发的RFdiffusion有一定相似之处。</p>
<p>开源代码: <a target="_blank" rel="noopener" href="https://github.com/generatebio/chroma">https://github.com/generatebio/chroma</a></p>
<p>论文地址：<a target="_blank" rel="noopener" href="https://www.nature.com/articles/s41586-023-06728-8">Illuminating protein space with a programmable generative model</a></p>
<span id="more"></span>
<h1 id="基本功能测试"><a href="#基本功能测试" class="headerlink" title="基本功能测试"></a>基本功能测试</h1><h2 id="无条件采样（Unconditonal-Sampling）"><a href="#无条件采样（Unconditonal-Sampling）" class="headerlink" title="无条件采样（Unconditonal Sampling）"></a>无条件采样（Unconditonal Sampling）</h2><p>最基础的采样生成，随机生成结构，可以分为单体生成和复合物生成，适合用于随机结构数据集的构建。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> appdirs</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> chroma <span class="keyword">import</span> Chroma</span><br><span class="line"><span class="keyword">from</span> pathlib <span class="keyword">import</span> Path</span><br><span class="line"></span><br><span class="line">out_dir = Path.cwd()</span><br><span class="line">TEST_TASK_ID=os.environ.get(<span class="string">&#x27;SLURM_JOBID&#x27;</span>, os.getpid())</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Test task id: &quot;</span>, TEST_TASK_ID)</span><br><span class="line">local_model_dir = Path(appdirs.user_cache_dir(<span class="string">&quot;chroma/weights&quot;</span>))</span><br><span class="line">chroma = Chroma(</span><br><span class="line">    weights_backbone=local_model_dir / <span class="string">&quot;chroma_backbone_v1.0.pt&quot;</span>,</span><br><span class="line">    weights_design=local_model_dir / <span class="string">&quot;chroma_design_v1.0.pt&quot;</span></span><br><span class="line">)</span><br><span class="line">protein = chroma.sample(chain_lengths=[<span class="number">100</span>,<span class="number">200</span>])</span><br><span class="line">protein.to(<span class="built_in">str</span>(out_dir /<span class="string">f&quot;unconditional_momomer_<span class="subst">&#123;TEST_TASK_ID&#125;</span>.pdb&quot;</span>))</span><br></pre></td></tr></table></figure>
<div style="display: flex; flex-wrap: wrap; justify-content: space-around; text-align: center;">
    <figure style="width: 45%; margin: 5px;">
        <img src="/2024/10/24/Chroma%E6%B5%8B%E8%AF%95%E4%B8%8Ebinder%E8%AE%BE%E8%AE%A1%E6%8E%A2%E7%B4%A2/SAMPLES_UNCONDITIONAL_MONOMER_TEST.PDB.png" alt="无条件单体采样">
        <figcaption>无条件单体采样</figcaption>
    </figure>
    <figure style="width: 45%; margin: 5px;">
        <img src="/2024/10/24/Chroma%E6%B5%8B%E8%AF%95%E4%B8%8Ebinder%E8%AE%BE%E8%AE%A1%E6%8E%A2%E7%B4%A2/SAMPLES_UNCONDITIONAL_COMPLEX_TEST.PDB.png" alt="无条件复合物采样">
        <figcaption>无条件复合物采样</figcaption>
    </figure>
</div>


<h2 id="指定二级结构采样（Secondary-Structure-Sampling）"><a href="#指定二级结构采样（Secondary-Structure-Sampling）" class="headerlink" title="指定二级结构采样（Secondary Structure Sampling）"></a>指定二级结构采样（Secondary Structure Sampling）</h2><p>算法支持指定每个氨基酸残基的二级结构（Helix为H，Sheet为E，loop为T）</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> appdirs</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> chroma <span class="keyword">import</span> Chroma, conditioners</span><br><span class="line"><span class="keyword">from</span> chroma.models <span class="keyword">import</span> graph_classifier</span><br><span class="line"><span class="keyword">from</span> pathlib <span class="keyword">import</span> Path</span><br><span class="line"></span><br><span class="line">out_dir = Path.cwd()</span><br><span class="line">TEST_TASK_ID=os.environ.get(<span class="string">&#x27;SLURM_JOBID&#x27;</span>, os.getpid())</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Test task id: &quot;</span>, TEST_TASK_ID)</span><br><span class="line">local_model_dir = Path(appdirs.user_cache_dir(<span class="string">&quot;chroma/weights&quot;</span>))</span><br><span class="line">device = <span class="string">&#x27;cuda:0&#x27;</span></span><br><span class="line">chroma = Chroma(</span><br><span class="line">    weights_backbone=local_model_dir / <span class="string">&quot;chroma_backbone_v1.0.pt&quot;</span>,</span><br><span class="line">    weights_design=local_model_dir / <span class="string">&quot;chroma_design_v1.0.pt&quot;</span>,</span><br><span class="line">    device=device</span><br><span class="line">)</span><br><span class="line">SS = <span class="string">&quot;EEEEETTTEEEEE&quot;</span></span><br><span class="line"></span><br><span class="line">proclass_model = graph_classifier.load_model(</span><br><span class="line">    local_model_dir / <span class="string">&quot;chroma_proclass_v1.0.pt&quot;</span>,</span><br><span class="line">    device=device)</span><br><span class="line">conditioner = conditioners.ProClassConditioner(</span><br><span class="line">    <span class="string">&quot;secondary_structure&quot;</span>, SS, max_norm=<span class="literal">None</span>,  model=proclass_model)</span><br><span class="line">protein = chroma.sample(</span><br><span class="line">    conditioner=conditioner,</span><br><span class="line">    chain_lengths=[<span class="built_in">len</span>(SS)]</span><br><span class="line">)</span><br><span class="line">protein.to(<span class="built_in">str</span>(out_dir / <span class="string">f&quot;ss_design_<span class="subst">&#123;TEST_TASK_ID&#125;</span>.pdb&quot;</span>))</span><br></pre></td></tr></table></figure>
<img src="/2024/10/24/Chroma%E6%B5%8B%E8%AF%95%E4%B8%8Ebinder%E8%AE%BE%E8%AE%A1%E6%8E%A2%E7%B4%A2/ss.png" class="" title="HHHHHHHTTTHHHHHHHTTTEEEEEETTTEEEEEEEETTTTHHHHHHHH">
<h2 id="符号形状采样（Symbol-like-Structure-Sampling）"><a href="#符号形状采样（Symbol-like-Structure-Sampling）" class="headerlink" title="符号形状采样（Symbol-like Structure Sampling）"></a>符号形状采样（Symbol-like Structure Sampling）</h2><p>这是一种炫技的蛋白结构设计，例如让设计蛋白结构像一个“G”。<br>但实测效果并没有那么像，论文中应该是选了典型case。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> appdirs</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> chroma <span class="keyword">import</span> Chroma, conditioners</span><br><span class="line"><span class="keyword">from</span> chroma.utility.chroma <span class="keyword">import</span> letter_to_point_cloud</span><br><span class="line"><span class="keyword">from</span> pathlib <span class="keyword">import</span> Path</span><br><span class="line"></span><br><span class="line">out_dir = Path.cwd()</span><br><span class="line">TEST_TASK_ID=os.environ.get(<span class="string">&#x27;SLURM_JOBID&#x27;</span>, os.getpid())</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Test task id: &quot;</span>, TEST_TASK_ID)</span><br><span class="line">local_model_dir = Path(appdirs.user_cache_dir(<span class="string">&quot;chroma/weights&quot;</span>))</span><br><span class="line">device = <span class="string">&#x27;cuda:0&#x27;</span></span><br><span class="line">chroma = Chroma(</span><br><span class="line">    weights_backbone=local_model_dir / <span class="string">&quot;chroma_backbone_v1.0.pt&quot;</span>,</span><br><span class="line">    weights_design=local_model_dir / <span class="string">&quot;chroma_design_v1.0.pt&quot;</span>,</span><br><span class="line">    device=device</span><br><span class="line">)</span><br><span class="line">character = <span class="string">&quot;G&quot;</span>  <span class="comment"># @param &#123;type:&quot;string&quot;&#125;</span></span><br><span class="line"><span class="keyword">if</span> <span class="built_in">len</span>(character) &gt; <span class="number">1</span>:</span><br><span class="line">    character = character[:<span class="number">1</span>]</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;Keeping only first character (<span class="subst">&#123;character&#125;</span>)!&quot;</span>)</span><br><span class="line">length = <span class="number">1000</span>  <span class="comment"># @param &#123;type:&quot;slider&quot;, min:100, max:1500, step:100&#125;</span></span><br><span class="line"></span><br><span class="line">letter_point_cloud = letter_to_point_cloud(character)</span><br><span class="line">conditioner = conditioners.ShapeConditioner(</span><br><span class="line">    letter_point_cloud,</span><br><span class="line">    chroma.backbone_network.noise_schedule,</span><br><span class="line">    autoscale_num_residues=length,</span><br><span class="line">).to(device)</span><br><span class="line"></span><br><span class="line">shaped_protein = chroma.sample(</span><br><span class="line">    chain_lengths=[length], conditioner=conditioner</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">shaped_protein.to(<span class="built_in">str</span>(out_dir / <span class="string">f&quot;shape_design_<span class="subst">&#123;TEST_TASK_ID&#125;</span>.pdb&quot;</span>))</span><br></pre></td></tr></table></figure>
<img src="/2024/10/24/Chroma%E6%B5%8B%E8%AF%95%E4%B8%8Ebinder%E8%AE%BE%E8%AE%A1%E6%8E%A2%E7%B4%A2/symbol_G.png" class="" title="字母G的形状">
<h2 id="CATH采样（CATH-based-Structure-Sampling）"><a href="#CATH采样（CATH-based-Structure-Sampling）" class="headerlink" title="CATH采样（CATH-based Structure Sampling）"></a>CATH采样（CATH-based Structure Sampling）</h2><p>CATH编号是对蛋白二级结构一种编码，算法能够根据给定CATH编号来生成对应的二级结构。<br>这实际上上是在前面的二级结构采样基础上，增加了对CATH的查询解析。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> appdirs</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> chroma <span class="keyword">import</span> Chroma, conditioners</span><br><span class="line"><span class="keyword">from</span> chroma.models <span class="keyword">import</span> graph_classifier</span><br><span class="line"><span class="keyword">from</span> pathlib <span class="keyword">import</span> Path</span><br><span class="line"></span><br><span class="line">out_dir = Path.cwd()</span><br><span class="line">TEST_TASK_ID=os.environ.get(<span class="string">&#x27;SLURM_JOBID&#x27;</span>, os.getpid())</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Test task id: &quot;</span>, TEST_TASK_ID)</span><br><span class="line">local_model_dir = Path(appdirs.user_cache_dir(<span class="string">&quot;chroma/weights&quot;</span>))</span><br><span class="line">device = <span class="string">&#x27;cuda:0&#x27;</span></span><br><span class="line">chroma = Chroma(</span><br><span class="line">    weights_backbone=local_model_dir / <span class="string">&quot;chroma_backbone_v1.0.pt&quot;</span>,</span><br><span class="line">    weights_design=local_model_dir / <span class="string">&quot;chroma_design_v1.0.pt&quot;</span>,</span><br><span class="line">    device=device</span><br><span class="line">)</span><br><span class="line">CATH = <span class="string">&quot;3.40.50&quot;</span>  <span class="comment"># @param &#123;type:&quot;string&quot;&#125;</span></span><br><span class="line">length = <span class="number">130</span>  <span class="comment"># @param &#123;type:&quot;slider&quot;, min:50, max:250, step:10&#125;</span></span><br><span class="line"></span><br><span class="line">proclass_model = graph_classifier.load_model(</span><br><span class="line">    local_model_dir / <span class="string">&quot;chroma_proclass_v1.0.pt&quot;</span>,</span><br><span class="line">    device=device)</span><br><span class="line">conditioner = conditioners.ProClassConditioner(<span class="string">&quot;cath&quot;</span>, CATH, model=proclass_model)</span><br><span class="line">cath_conditioned_protein = chroma.sample(</span><br><span class="line">    conditioner=conditioner,</span><br><span class="line">    chain_lengths=[length]</span><br><span class="line">)</span><br><span class="line">cath_conditioned_protein.to(<span class="built_in">str</span>(out_dir / <span class="string">f&quot;fold_design_<span class="subst">&#123;TEST_TASK_ID&#125;</span>.pdb&quot;</span>))</span><br></pre></td></tr></table></figure>
<img src="/2024/10/24/Chroma%E6%B5%8B%E8%AF%95%E4%B8%8Ebinder%E8%AE%BE%E8%AE%A1%E6%8E%A2%E7%B4%A2/cath.png" class="" title="CATH 3.40.50 Rossmann fold">
<h2 id="提示词采样（Prompt-based-Structure-Sampling）"><a href="#提示词采样（Prompt-based-Structure-Sampling）" class="headerlink" title="提示词采样（Prompt-based Structure Sampling）"></a>提示词采样（Prompt-based Structure Sampling）</h2><p>内嵌了LLM模型，用来支持基于给定提示词进行结构生成，<br>但实测效果不咋样，而且这样做的商业意义很有限。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> appdirs</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> chroma <span class="keyword">import</span> Chroma, conditioners</span><br><span class="line"><span class="keyword">from</span> chroma.models <span class="keyword">import</span> procap</span><br><span class="line"><span class="keyword">from</span> pathlib <span class="keyword">import</span> Path</span><br><span class="line"></span><br><span class="line">out_dir = Path.cwd()</span><br><span class="line">TEST_TASK_ID=os.environ.get(<span class="string">&#x27;SLURM_JOBID&#x27;</span>, os.getpid())</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Test task id: &quot;</span>, TEST_TASK_ID)</span><br><span class="line">local_model_dir = Path(appdirs.user_cache_dir(<span class="string">&quot;chroma/weights&quot;</span>))</span><br><span class="line">lm_model_dir = Path(appdirs.user_cache_dir(</span><br><span class="line">    <span class="string">&quot;huggingface/hub/models--EleutherAI--gpt-neo-125m/snapshots/6cb0d322a3a484e99667e7cb240e22f1ac036b99&quot;</span>))</span><br><span class="line">device = <span class="string">&#x27;cuda:0&#x27;</span></span><br><span class="line">chroma = Chroma(</span><br><span class="line">    weights_backbone=local_model_dir / <span class="string">&quot;chroma_backbone_v1.0.pt&quot;</span>,</span><br><span class="line">    weights_design=local_model_dir / <span class="string">&quot;chroma_design_v1.0.pt&quot;</span>,</span><br><span class="line">    device=device</span><br><span class="line">)</span><br><span class="line">length = <span class="number">110</span>  <span class="comment"># @param &#123;type:&quot;slider&quot;, min:50, max:250, step:10&#125;</span></span><br><span class="line">caption = <span class="string">&quot;Crystal structure of SH2 domain&quot;</span>  <span class="comment"># @param &#123;type:&quot;string&quot;&#125;</span></span><br><span class="line"></span><br><span class="line">procap_model = procap.load_model(</span><br><span class="line">    local_model_dir / <span class="string">&quot;chroma_procap_v1.0.pt&quot;</span>,</span><br><span class="line">    device=device,</span><br><span class="line">    lm_id=lm_model_dir)</span><br><span class="line">conditioner = conditioners.ProCapConditioner(caption, -<span class="number">1</span>, model=procap_model)</span><br><span class="line">protein = chroma.sample(</span><br><span class="line">    steps=<span class="number">200</span>, chain_lengths=[length], conditioner=conditioner</span><br><span class="line">)</span><br><span class="line">protein.to(<span class="built_in">str</span>(out_dir / <span class="string">f&quot;procap_design_<span class="subst">&#123;TEST_TASK_ID&#125;</span>.pdb&quot;</span>))</span><br></pre></td></tr></table></figure>
<img src="/2024/10/24/Chroma%E6%B5%8B%E8%AF%95%E4%B8%8Ebinder%E8%AE%BE%E8%AE%A1%E6%8E%A2%E7%B4%A2/prompt.png" class="" title="Caption: Crystal structure of VHH nanobody">
<h2 id="全结构重采样（Full-structure-resampling）"><a href="#全结构重采样（Full-structure-resampling）" class="headerlink" title="全结构重采样（Full structure resampling）"></a>全结构重采样（Full structure resampling）</h2><p>算法可以做给定结构的重新采样，但采样效果与原始结构不像。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> appdirs</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> chroma <span class="keyword">import</span> Chroma, Protein</span><br><span class="line"><span class="keyword">from</span> pathlib <span class="keyword">import</span> Path</span><br><span class="line"></span><br><span class="line">out_dir = Path.cwd()</span><br><span class="line">TEST_TASK_ID=os.environ.get(<span class="string">&#x27;SLURM_JOBID&#x27;</span>, os.getpid())</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Test task id: &quot;</span>, TEST_TASK_ID)</span><br><span class="line">local_model_dir = Path(appdirs.user_cache_dir(<span class="string">&quot;chroma/weights&quot;</span>))</span><br><span class="line">protein = Protein(<span class="string">&quot;FC-III-AAPC.pdb&quot;</span>, device=<span class="string">&quot;cuda:0&quot;</span>)</span><br><span class="line">chroma = Chroma(</span><br><span class="line">    weights_backbone=local_model_dir / <span class="string">&quot;chroma_backbone_v1.0.pt&quot;</span>,</span><br><span class="line">    weights_design=local_model_dir / <span class="string">&quot;chroma_design_v1.0.pt&quot;</span></span><br><span class="line">)</span><br><span class="line">protein = chroma.sample(</span><br><span class="line">    protein_init=protein</span><br><span class="line">    )</span><br><span class="line">protein.to(<span class="built_in">str</span>(out_dir / <span class="string">f&quot;full_resample_<span class="subst">&#123;TEST_TASK_ID&#125;</span>.pdb&quot;</span>))</span><br></pre></td></tr></table></figure>
<div style="display: flex; flex-wrap: wrap; justify-content: space-around; text-align: center;">
    <figure style="width: 45%; margin: 5px;">
        <img src="/2024/10/24/Chroma%E6%B5%8B%E8%AF%95%E4%B8%8Ebinder%E8%AE%BE%E8%AE%A1%E6%8E%A2%E7%B4%A2/full_design_before.png" alt="full_design_before.png">
        <figcaption>Init protein: FCIII & Fc fragment</figcaption>
    </figure>
    <figure style="width: 45%; margin: 5px;">
        <img src="/2024/10/24/Chroma%E6%B5%8B%E8%AF%95%E4%B8%8Ebinder%E8%AE%BE%E8%AE%A1%E6%8E%A2%E7%B4%A2/full_design_after.png" alt="full_design_after.png">
        <figcaption>Fully resampled</figcaption>
    </figure>
</div>

<h2 id="局部重采样（Partial-structure-resampling）"><a href="#局部重采样（Partial-structure-resampling）" class="headerlink" title="局部重采样（Partial structure resampling）"></a>局部重采样（Partial structure resampling）</h2><p>局部重新采样是指可以选择给定区域进行重新设计而保留其他区域。<br>chroma通过一个类似pymol的selection语法进行结构的局部选择。<br>重新采样设计的差异性较大。<br>测试发现partial resampling其实是对局部结构的完全sampling，<br>不能基于已有的局部结构，<br>当然这可以作为固定receptor进行完全重新设计binder。</p>
<p>同时，测试使用了<code>conditioners.ComposedConditioner([ss_conditioner, sub_conditioner])</code>整合多个conditioner，<br>但发现会存在互相影响，<br>例如这里使用了生成指定二级结构类型的conditoner和指定结构区域的conditioner，<br>发现二级结构类型不好指定生成，生成结构和上面的类似。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> appdirs</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">from</span> chroma <span class="keyword">import</span> Chroma, Protein, conditioners</span><br><span class="line"><span class="keyword">from</span> chroma.models <span class="keyword">import</span> graph_classifier</span><br><span class="line"><span class="keyword">from</span> pathlib <span class="keyword">import</span> Path</span><br><span class="line"></span><br><span class="line">out_dir = Path.cwd()</span><br><span class="line">TEST_TASK_ID=os.environ.get(<span class="string">&#x27;SLURM_JOBID&#x27;</span>, os.getpid())</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Test task id: &quot;</span>, TEST_TASK_ID)</span><br><span class="line">local_model_dir = Path(appdirs.user_cache_dir(<span class="string">&quot;chroma/weights&quot;</span>))</span><br><span class="line"></span><br><span class="line">device = <span class="string">&quot;cuda:0&quot;</span> <span class="keyword">if</span> torch.cuda.is_available() <span class="keyword">else</span> <span class="string">&quot;cpu&quot;</span></span><br><span class="line">protein = Protein(<span class="string">&quot;FC-III-AAPC.pdb&quot;</span>, device=device)</span><br><span class="line">chroma = Chroma(</span><br><span class="line">    weights_backbone=local_model_dir / <span class="string">&quot;chroma_backbone_v1.0.pt&quot;</span>,</span><br><span class="line">    weights_design=local_model_dir / <span class="string">&quot;chroma_design_v1.0.pt&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">conditioner = conditioners.SubstructureConditioner(</span><br><span class="line">    protein,</span><br><span class="line">    chroma.backbone_network,</span><br><span class="line">    selection=<span class="string">&quot;not chain E&quot;</span>).to(device)</span><br><span class="line"></span><br><span class="line">protein = chroma.sample(</span><br><span class="line">    protein_init=protein,</span><br><span class="line">    conditioner=conditioner,</span><br><span class="line">    design_selection=<span class="string">&quot;chain E&quot;</span>,</span><br><span class="line">    langevin_factor=<span class="number">1</span>,</span><br><span class="line">    inverse_temperature=<span class="number">2</span>,</span><br><span class="line">    sde_func=<span class="string">&#x27;langevin&#x27;</span>,</span><br><span class="line">)</span><br><span class="line">protein.to(<span class="built_in">str</span>(out_dir / <span class="string">f&quot;partial_resample_<span class="subst">&#123;TEST_TASK_ID&#125;</span>.pdb&quot;</span>))</span><br></pre></td></tr></table></figure>
<div style="display: flex; flex-wrap: wrap; justify-content: space-around; text-align: center;">
    <figure style="width: 45%; margin: 5px;">
        <img src="" alt="parital_design_before.png">
        <figcaption>Init protein: FCIII & Fc fragment</figcaption>
    </figure>
    <figure style="width: 45%; margin: 5px;">
        <img src="" alt="parital_design_after.png">
        <figcaption>Partial resampling的结果</figcaption>
    </figure>
</div>

<h1 id="Denovo-Binder-Design"><a href="#Denovo-Binder-Design" class="headerlink" title="Denovo Binder Design"></a>Denovo Binder Design</h1><h2 id="Fc-Fragment-Binder-design"><a href="#Fc-Fragment-Binder-design" class="headerlink" title="Fc Fragment Binder design"></a>Fc Fragment Binder design</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> appdirs</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">from</span> chroma <span class="keyword">import</span> Chroma, Protein, conditioners</span><br><span class="line"><span class="keyword">from</span> chroma.models <span class="keyword">import</span> graph_classifier</span><br><span class="line"><span class="keyword">from</span> pathlib <span class="keyword">import</span> Path</span><br><span class="line"></span><br><span class="line">out_dir = Path.cwd()</span><br><span class="line">TEST_TASK_ID=os.environ.get(<span class="string">&#x27;SLURM_JOBID&#x27;</span>, os.getpid())</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Test task id: &quot;</span>, TEST_TASK_ID)</span><br><span class="line">local_model_dir = Path(appdirs.user_cache_dir(<span class="string">&quot;chroma/weights&quot;</span>))</span><br><span class="line"></span><br><span class="line">device = <span class="string">&quot;cuda:0&quot;</span> <span class="keyword">if</span> torch.cuda.is_available() <span class="keyword">else</span> <span class="string">&quot;cpu&quot;</span></span><br><span class="line">protein = Protein(<span class="string">&quot;igg_fragment.pdb&quot;</span>, device=device)</span><br><span class="line"></span><br><span class="line">X, C, S = protein.to_XCS()</span><br><span class="line"></span><br><span class="line">binder_len = <span class="number">40</span></span><br><span class="line"></span><br><span class="line">X_new = torch.cat([X, torch.zeros(<span class="number">1</span>, binder_len, <span class="number">4</span>, <span class="number">3</span>, device=device)], dim=<span class="number">1</span>)</span><br><span class="line">C_new = torch.cat([C, torch.full((<span class="number">1</span>, binder_len), C.<span class="built_in">max</span>() + <span class="number">1</span>, device=device)], dim=<span class="number">1</span>)</span><br><span class="line">S_new = torch.cat([S, torch.full((<span class="number">1</span>, binder_len), <span class="number">0</span>, device=device)], dim=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">protein = Protein(X_new, C_new, S_new, device=device)</span><br><span class="line"></span><br><span class="line">chroma = Chroma(</span><br><span class="line">    weights_backbone=local_model_dir / <span class="string">&quot;chroma_backbone_v1.0.pt&quot;</span>,</span><br><span class="line">    weights_design=local_model_dir / <span class="string">&quot;chroma_design_v1.0.pt&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">proclass_model = graph_classifier.load_model(</span><br><span class="line">     local_model_dir / <span class="string">&quot;chroma_proclass_v1.0.pt&quot;</span>,</span><br><span class="line">     device=device)</span><br><span class="line">beta_conditioner = conditioners.ProClassConditioner(</span><br><span class="line">     <span class="string">&quot;cath&quot;</span>,</span><br><span class="line">     <span class="string">&quot;2&quot;</span>,</span><br><span class="line">     max_norm=<span class="literal">None</span>,</span><br><span class="line">     model=proclass_model).to(device)</span><br><span class="line"></span><br><span class="line">sub_conditioner = conditioners.SubstructureConditioner(</span><br><span class="line">    protein,</span><br><span class="line">    chroma.backbone_network,</span><br><span class="line">    selection=<span class="string">&quot;chain A&quot;</span>).to(device)</span><br><span class="line"></span><br><span class="line">protein = chroma.sample(</span><br><span class="line">    protein_init=protein,</span><br><span class="line">    conditioner=conditioners.ComposedConditioner([sub_conditioner, beta_conditioner]),</span><br><span class="line">    design_selection=<span class="string">&quot;not chain A&quot;</span>,</span><br><span class="line">    langevin_factor=<span class="number">2</span>,</span><br><span class="line">    langevin_isothermal=<span class="literal">True</span>,</span><br><span class="line">    inverse_temperature=<span class="number">8.0</span>,</span><br><span class="line">    sde_func=<span class="string">&#x27;langevin&#x27;</span>,</span><br><span class="line">    steps=<span class="number">800</span></span><br><span class="line">)</span><br><span class="line">protein.to(<span class="built_in">str</span>(out_dir / <span class="string">f&quot;binder_design_<span class="subst">&#123;TEST_TASK_ID&#125;</span>.pdb&quot;</span>))</span><br></pre></td></tr></table></figure>
<p>通过构造pesudo-chain，利用<code>conditioners.SubstructureConditioner</code>可以实现针对给定receptor的binder生成，<br>同时组合使用<code>conditioners.ProClassConditioner</code>可以引导生成特定类型的二级结构。<br>如示例尝试对Fc生成一个40aa的binder，<br>同时约束其为特定的二级结构，<br>并使用colabfold进行验证。<br>结果表明，<br>chroma的骨架生成模型能生成较好的预期骨架，<br>序列设计也能比较fit骨架，<br>但是对docking pose的设计准确性欠佳（当然可能是colabfold不准）。</p>
<div style="display: flex; flex-wrap: wrap; justify-content: space-around; text-align: center;">
    <figure style="width: 45%; margin: 5px;">
        <img src="/2024/10/24/Chroma%E6%B5%8B%E8%AF%95%E4%B8%8Ebinder%E8%AE%BE%E8%AE%A1%E6%8E%A2%E7%B4%A2/fc_binder_1.png" alt="fc binder 1">
        <figcaption>CATH=1 (helix), length=40aa</figcaption>
    </figure>
    <figure style="width: 45%; margin: 5px;">
        <img src="/2024/10/24/Chroma%E6%B5%8B%E8%AF%95%E4%B8%8Ebinder%E8%AE%BE%E8%AE%A1%E6%8E%A2%E7%B4%A2/fc_binder_2.png" alt="fc binder 2">
        <figcaption>CATH=2(sheet), length=40aa</figcaption>
    </figure>
</div>

<p>但目前的过程并没有任何对表位或者hotspot残基进行指定的设计，<br>根据原文支持材料，<br>应该是有一个<code>substructure distances</code>的conditioner可以完成这个实现，<br>但在开源版本中并没有相关提供，<br>不过根据这个conditioner开发指南和支持材料中给的逻辑推导，<br>自行实现应该是具有可行度。</p>
<img src="/2024/10/24/Chroma%E6%B5%8B%E8%AF%95%E4%B8%8Ebinder%E8%AE%BE%E8%AE%A1%E6%8E%A2%E7%B4%A2/chroma_supp_t6.png" class="">
<p>三、总结<br>Chroma是在RFdiffusion之后一个不错结构diffusion设计算法，<br>但是在给定靶点和表位的设计上，还需要我们做更多技术性验证。</p>
</div><div class="post-copyright"><div class="post-copyright-author"><span class="post-copyright-meta">本文作者: </span><span class="post-copyright-info"><a href="mailto:undefined">GCS-ZHN</a></span></div><div class="post-copyright-type"><span class="post-copyright-meta">本文链接: </span><span class="post-copyright-info"><a href="https://gcszhn.top/2024/10/24/Chroma%E6%B5%8B%E8%AF%95%E4%B8%8Ebinder%E8%AE%BE%E8%AE%A1%E6%8E%A2%E7%B4%A2/">https://gcszhn.top/2024/10/24/Chroma测试与binder设计探索/</a></span></div><div class="post-copyright-notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://gcszhn.top">潇洒记忆</a>！</span></div></div></article><div id="pagination"><div class="next-post pull-right"><span class="line line-top"></span><span class="line line-right"></span><span class="line line-bottom"></span><span class="line line-left"></span><a href="/2024/10/23/BindCraft%E7%AE%97%E6%B3%95%E8%A7%A3%E6%9E%90%E5%92%8C%E6%B5%8B%E8%AF%95/"><span>BindCraft算法解析和测试</span><span>&nbsp;</span><i class="fas fa-angle-right"></i></a></div></div><!--div!= paginator()--></div></div><div class="button-hover" id="return-top"><i class="fas fa-arrow-up" aria-hidden="true"></i></div><footer><div id="footer"><div class="button-hover" id="side-button"><i class="fas fa-arrow-right"></i></div><div class="right-content"><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fas fa-file-o"></i></span><span id="busuanzi_value_page_pv"></span><span></span></div><div class="copyright">&copy;2017 ～ 2024 By GCS-ZHN</div><a href="https://beian.miit.gov.cn/" target="_blank">&nbsp; 浙ICP备2022014039号</a></div></div></footer></div><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/thirdparty/jquery-3.3.1.min.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/thirdparty/velocity.min.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/thirdparty/jquery.mCustomScrollbar.concat.min.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/fan.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/canvas_bg.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/utils.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/scroll.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/sidebar.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/copy.js"></script><!--script(src=url)--></body></html>